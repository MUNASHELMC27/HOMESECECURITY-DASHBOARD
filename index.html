<!DOCTYPE html>
<html>
<head>
  <title>ESP32 Hazard Monitoring Dashboard</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js"></script>
</head>
<body>
  <h2>ESP32 Hazard Monitoring Dashboard</h2>
  <div>
    <p><strong>Sensor Data:</strong> <span id="sensor-data">Waiting...</span></p>
    <p><strong>Alert:</strong> <span id="hazard-alert">None</span></p>
  </div>

  <script>
    const client = new Paho.MQTT.Client("broker.hivemq.com", 8000, "webClient-" + parseInt(Math.random() * 100, 10));
    client.onMessageArrived = onMessageArrived;
    client.onConnectionLost = () => console.log("Connection lost");
    client.connect({
      onSuccess: () => {
        console.log("Connected to broker");
        client.subscribe("esp32/hazard/data");
        client.subscribe("esp32/hazard/alert");
      }
    });

    function onMessageArrived(message) {
      if (message.destinationName === "esp32/hazard/data") {
        document.getElementById("sensor-data").textContent = message.payloadString;
      } else if (message.destinationName === "esp32/hazard/alert") {
        document.getElementById("hazard-alert").textContent = message.payloadString;
      }
    }
  </script>
</body>
</html>
